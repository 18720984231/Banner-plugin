!function(e){"use strict";Array.prototype.indexOf=function(e){for(var t in this)if(e===this[t])return t;return-1},String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};var t=function(t,n){this.opts=e.extend({},e.fn.Banner.defaults,n),this.$ele=e(t),this.init()};t.prototype={init:function(){var e=this,t="boolean"!=typeof e.opts.loop||e.opts.loop,n="boolean"!=typeof e.opts.arrow||e.opts.arrow,i="boolean"!=typeof e.opts.autoplay||e.opts.autoplay,a="boolean"!=typeof e.opts.pagination||e.opts.pagination,o="number"==typeof e.opts.startIndex?parseInt(e.opts.startIndex):0,s="number"==typeof e.opts.speed&&e.opts.speed>0?parseInt(e.opts.speed):500,r="number"==typeof e.opts.itemSpacing&&e.opts.itemSpacing>0?parseInt(e.opts.itemSpacing):0;if(e.loop=t,e.speed=s,e.animated=!1,e.itemSpacing=r,e.ieVersion=e.getIeVersion(),e.isFlex=e.isSupportFlex(),e.animation=e.getAnimation(),e.bannerWrapper=e.$ele.find(".banner-wrapper"),e.items=e.bannerWrapper.find(".banner-item"),e.isHorizontal="vertical"!==e.opts.direction,e.eventType="pc"===e.judgePlatform()?"click":"touchstart",e.curIndex=o>0&&o<e.getItemsLength()?o:0,e.itemSize=e.isHorizontal?e.items.eq(0).outerWidth():e.items.eq(0).outerHeight(),!e.isFlex){var p=e.items.eq(0).outerHeight();e.$ele.addClass("banner-no-flexbox").css("height",p+"px")}t&&e.createLoop(),"cube"!==e.opts.animation||e.isFlex&&void 0===e.ieVersion||alert("您的浏览器暂不支持3D动画，请使用最新版的chrome浏览器！"),"fade"===e.animation?e.fade():"cube"===e.animation?e.cube():e.slide(),a&&e.pagination(),n&&e.arrow(),i&&e.autoplay(),e.itemSpacing&&"slide"===e.animation&&e.setItemSpace(e.itemSpacing),e.isHorizontal||e.vertical(),e.curIndex&&(e.isSetStart=!0,e.play(e.curIndex)),e.initEvent()},createLoop:function(){var e=this,t=e.items.eq(0).clone(!0),n=e.items.eq(e.items.length-1).clone(!0);e.bannerWrapper.append(t).prepend(n),e.items=e.bannerWrapper.find(".banner-item"),e.updateWrapper()},updateWrapper:function(){var e=this,t=e.itemSize,n=e.curIndex+1,i=e.itemSpacing;"slide"===e.animation&&(e.isFlex?(e.bannerWrapper.css("transitionDuration","0ms"),e.isHorizontal?e.bannerWrapper.css("transform","translate3d(-"+(t+i)*n+"px, 0, 0)"):e.bannerWrapper.css("transform","translate3d(0, -"+(t+i)*n+"px, 0)")):e.isHorizontal?e.bannerWrapper.css("left",-(t+i)*n+"px"):e.bannerWrapper.css("top",-(t+i)*n+"px"))},setItemSpace:function(e){for(var t=this,n=t.getItemsLength(),i=0;i<n;i++)t.isHorizontal?t.isFlex&&t.items.eq(i).css("marginRight",e+"px"):t.items.eq(i).css("marginBottom",e+"px")},vertical:function(){var e=this.itemSize;this.$ele.addClass("banner-vertical"),this.bannerWrapper.css("height",e+"px")},cube:function(){for(var e=this,t=e.items,n=e.itemSize,i=e.getItemsLength(),a=e.isHorizontal,o=e.bannerWrapper,s=e.loop?90:0,r=e.loop?e.curIndex+1:e.curIndex,p=0;p<i;p++){var c=90*p,l=Math.floor(p/4);a?p%4===0?t.eq(p).css("transform","rotateY("+c+"deg) translate3d("+4*-l*n+"px, 0, 0)"):p%4===1?t.eq(p).css("transform","rotateY("+c+"deg) translate3d(0, 0, "+4*-l*n+"px)"):p%4===2?t.eq(p).css("transform","rotateY("+c+"deg) translate3d("+(n+4*l*n)+"px, 0, "+n+"px)"):p%4===3&&t.eq(p).css("transform","rotateY("+c+"deg) translate3d("+-n+"px, 0, "+(3*n+4*n*l)+"px)"):p%4===0?t.eq(p).css("transform","rotateX("+-c+"deg) translate3d(0, "+4*-l*n+"px, 0)"):p%4===1?t.eq(p).css("transform","rotateX("+-c+"deg) translate3d(0, 0, "+4*-l*n+"px)"):p%4===2?t.eq(p).css("transform","rotateX("+-c+"deg) translate3d(0, "+(n+4*l*n)+"px, "+n+"px)"):p%4===3&&t.eq(p).css("transform","rotateX("+-c+"deg) translate3d(0, "+-n+"px, "+(3*n+4*n*l)+"px)")}e.$ele.addClass("banner-cube"),t.eq(r).css("visibility","visible"),o.css("transformOrigin","50% 50% "+-(n/2)+"px"),e.loop&&o.css("transitionDuration","0ms"),!a&&o.css("transform","rotateX("+s+"deg)"),a&&o.css("transform","rotateY(-"+s+"deg)")},fade:function(){for(var e=this,t=e.items,n=e.getItemsLength(),i=e.loop?e.curIndex+1:e.curIndex,a=0;a<n;a++)e.isFlex?(t.eq(a).css({transitionDuration:"0ms",opacity:0}),e.ieVersion<=8&&t.eq(a).css("filter","alpha(opacity=0)"),e.isHorizontal?t.eq(a).css("transform","translate3d(-"+e.itemSize*a+"px, 0, 0)"):t.eq(a).css("transform","translate3d(0, -"+e.itemSize*a+"px, 0)")):(t.eq(a).css({position:"absolute",top:0,opacity:0}),e.ieVersion<=8&&t.eq(a).css("filter","alpha(opacity=0)"));e.$ele.addClass("banner-fade"),t.eq(i).css("opacity",1),e.ieVersion<=8&&t.eq(i).css("filter","alpha(opacity=100)")},slide:function(){var e=this,t=e.getItemsLength();if(!e.isFlex)if(e.isHorizontal){!e.loop&&e.bannerWrapper.css("left",0);for(var n=0;n<t;n++){var i=0===n?e.itemSize*n:(e.itemSize+e.itemSpacing)*n;e.items.eq(n).css({position:"absolute",left:i+"px"})}}else!e.loop&&e.bannerWrapper.css("top",0)},swiperEvent:function(){var t=this;t.isMove=!1,"pc"===t.judgePlatform()?(t.bannerWrapper.on("mousedown",function(e){t.isMove=!0,t.onTouchstart(e)}),e(document).on("mousemove",function(e){t.isMove&&t.onTouchmove(e),t.timer&&t.isMove&&clearInterval(t.timer)}).on("mouseup",function(e){t.isMove=!1,t.onTouchEnd(e)})):t.bannerWrapper.on("touchstart",function(e){t.isMove=!0,t.onTouchstart(e)}).on("touchmove",function(e){t.isMove&&t.onTouchmove(e)}).on("touchend",function(e){t.isMove=!1,t.onTouchEnd(e)})},swiperDirection:function(){var e=this,t=e.angle,n=e.offsetTime>500?parseInt(e.itemSize/2):50,i=function(n){console.log(e.isMove),e.offset>=n&&t>=-45&&t<45?e.prev():e.offset<-n&&(t>=135&&t<=180||t>=-180&&t<-135)?e.next():void 0!==e.offset&&0!==e.offset&&(t>=-45&&t<45||t>=135&&t<=180||t>=-180&&t<-135)&&!e.animated&&e.play(e.curIndex)},a=function(n){e.offset>=n&&t>=45&&t<135?e.prev():e.offset<-n&&t>=-135&&t<-45?e.next():0!==e.offset&&(t>=45&&t<135||t>=-135&&t<-45)&&!e.animated&&e.play(e.curIndex)};e.isHorizontal?i(n):a(n)},stopPrevent:function(e){e.stopPropagation?(e.stopPropagation(),e.preventDefault()):(e.cancelBubble=!0,e.returnValue=!1)},onTouchstart:function(e){e=e||window.event,this.stopPrevent(e),this.startTime=(new Date).getTime(),this.startX="touchstart"===e.type?e.originalEvent.targetTouches[0].pageX:e.pageX||e.clientX,this.startY="touchstart"===e.type?e.originalEvent.targetTouches[0].pageY:e.pageY||e.clientY},onTouchmove:function(e){e=e||window.event;var t=this,n=t.itemSize,i=t.curIndex,a=t.itemSpacing,o=t.bannerWrapper,s="touchmove"===e.type?e.originalEvent.targetTouches[0].pageX:e.pageX||e.clientX,r="touchmove"===e.type?e.originalEvent.targetTouches[0].pageY:e.pageY||e.clientY,p=t.loop===!0?-(n+a):0;t.stopPrevent(e),t.dx=s-t.startX,t.dy=r-t.startY,t.offset=t.isHorizontal?t.dx:t.dy,t.angle=parseInt(180*Math.atan2(t.dy,t.dx)/Math.PI),"slide"===t.animation&&t.isFlex&&(o.css("transitionDuration","0ms"),t.isHorizontal?(t.angle>=-45&&t.angle<45||t.angle>=135&&t.angle<=180||t.angle>=-180&&t.angle<-135)&&!t.animated&&o.css("transform","translate3d("+(t.offset+-(n+a)*i+p)+"px, 0, 0)"):(t.angle>=45&&t.angle<135||t.angle>=-135&&t.angle<-45)&&!t.animated&&o.css("transform","translate3d(0, "+(t.offset+-(n+a)*i+p)+"px, 0)"))},onTouchEnd:function(e){var t=this;e=e||window.event,t.stopPrevent(e),t.offsetTime=(new Date).getTime()-t.startTime,Math.abs(t.dx)<2&&Math.abs(t.dy)<2||!t.animated&&t.swiperDirection()},play:function(e){var t=this;t.isFlex?("fade"===t.animation?t.gradient(e):"cube"===t.animation?t.rotate(e):t.translate(e),t.setTransition(),t.transitionEnd()):"fade"===t.animation?t.changeOpacity(e):t.changePos(e),t.setPagination(e)},setTransition:function(){var e=this,t=e.getItemsLength();if(e.isSetStart&&0!==e.curIndex){if("fade"===e.animation)for(var n=0;n<t;n++)e.items.eq(n).css("transitionDuration","0ms");else e.bannerWrapper.css("transitionDuration","0ms");e.isSetStart=!1,e.animated=!1}else if(e.animated=!0,"fade"===e.animation)for(var n=0;n<t;n++)e.items.eq(n).css("transitionDuration",e.speed+"ms");else e.bannerWrapper.css("transitionDuration",e.speed+"ms")},transitionEnd:function(){var e=this;"cube"===e.animation?e.rotateEnd():"fade"===e.animation?e.gradientEnd():e.translateEnd()},translate:function(e){var t=this,n=t.loop?t.itemSize+t.itemSpacing:0,i=(t.itemSize+t.itemSpacing)*e+n;t.isHorizontal?t.bannerWrapper.css("transform","translate3d(-"+i+"px, 0, 0)"):t.bannerWrapper.css("transform","translate3d(0, -"+i+"px, 0)")},rotate:function(e){for(var t=this,n=t.items,i=t.getItemsLength(),a=90*e,o=t.loop?90:0,s=0;s<i;s++)n.eq(s).css("visibility","hidden");t.loop?(n.eq(e)&&n.eq(e).css("visibility","visible"),n.eq(e+1)&&n.eq(e+1).css("visibility","visible"),n.eq(e+2)&&n.eq(e+2).css("visibility","visible")):(n.eq(e)&&n.eq(e).css("visibility","visible"),n.eq(e+1)&&n.eq(e+1).css("visibility","visible"),n.eq(e-1)&&n.eq(e-1).css("visibility","visible")),t.isHorizontal?t.bannerWrapper.css("transform","rotateY(-"+(a+o)+"deg)"):t.bannerWrapper.css("transform","rotateX("+(a+o)+"deg)")},gradient:function(e){for(var t=this,n=t.getItemsLength(),i=0;i<n;i++)t.items.eq(i).css("opacity","0");t.loop?t.items.eq(e+1).css("opacity","1"):t.items.eq(e).css("opacity","1")},changePos:function(e){var t=this,n={},e=t.loop?e+1:e,i=t.isHorizontal?"left":"top",a=-1*e*(t.itemSize+t.itemSpacing);return t.isSetStart&&0!==t.curIndex?(t.isSetStart=!1,t.isHorizontal&&t.bannerWrapper.css("left",a+"px"),void(!t.isHorizontal&&t.bannerWrapper.css("top",a+"px"))):(t.animated=!0,n[i]=a+"px",void t.bannerWrapper.animate(n,t.speed,function(){t.changePosEnd()}))},changeOpacity:function(e){function t(){o=Number(i.eq(e).css("filter").replace(/[^0-9]/gi,"")),o<100?(i.eq(e).css("filter","alpha(opacity="+(o+r)+")"),setTimeout(t,100)):n.changeOpacityEnd()}var n=this,i=n.items,a=n.getItemsLength(),e=n.loop?e+1:e;if(n.isSetStart&&0!==n.curIndex)return n.isSetStart=!1,i.eq(e).css("opacity",1),void(n.ieVersion<=8&&i.eq(e).css("filter","alpha(opacity=100)"));if(n.animated=!0,i.eq(e).animate({opacity:1},n.speed,function(){n.changeOpacityEnd()}),n.ieVersion&&n.ieVersion<=8){for(var o=Number(i.eq(e).css("filter").replace(/[^0-9]/gi,"")),s=100-o,r=s/(n.speed/100),p=0;p<a;p++)i.eq(p).css("filter","alpha(opacity=0)");t()}},translateEnd:function(){var e=this,t=0,n=0,i=e.getItemsLength(),a=e.bannerWrapper,t=e.loop?e.itemSize+e.itemSpacing:0;a.on("transitionend webkitTransitionEnd mozTransitionEnd oTransitionEnd",function(){e.offset=0,e.animated=!1,a.css("transitionDuration","0ms"),e.loop&&(e.curIndex>=i-2?(e.curIndex=0,n=(e.itemSize+e.itemSpacing)*e.curIndex+t,e.isHorizontal?a.css("transform","translate3d(-"+n+"px, 0, 0)"):a.css("transform","translate3d(0, -"+n+"px, 0)")):e.curIndex===-1&&(e.curIndex=i-3,n=(e.itemSize+e.itemSpacing)*e.curIndex+t,e.isHorizontal?a.css("transform","translate3d(-"+n+"px, 0, 0)"):a.css("transform","translate3d(0, -"+n+"px, 0)")))})},gradientEnd:function(){var e=this,t=e.items,n=e.getItemsLength(),i=e.loop?e.curIndex+1:e.curIndex;t.eq(i).on("transitionend webkitTransitionEnd mozTransitionEnd oTransitionEnd",function(){e.animated=!1,e.offset=0;for(var i=0;i<n;i++)t.eq(i).css("transitionDuration","0ms");e.loop&&(e.curIndex>=n-2?(e.curIndex=0,t.eq(n-1).css("opacity",0),t.eq(e.curIndex+1).css("opacity",1)):e.curIndex===-1&&(e.curIndex=n-3,t.eq(0).css("opacity",0),t.eq(n-2).css("opacity",1)))})},rotateEnd:function(){var e=this,t=e.items,n=e.getItemsLength(),i=e.bannerWrapper,a=e.loop===!0?90:0;i.on("transitionend webkitTransitionEnd mozTransitionEnd oTransitionEnd",function(){e.animated=!1,e.offset=0,i.css("transitionDuration","0ms");for(var o=0;o<n;o++)t.eq(o).css("visibility","hidden");e.loop?(n=e.items.length,e.curIndex===n-2?(e.curIndex=0,e.isHorizontal?i.css("transform","rotateY(-"+a+"deg)"):i.css("transform","rotateX("+a+"deg)")):e.curIndex===-1&&(e.curIndex=n-3,e.isHorizontal?i.css("transform","rotateY(-"+(a+90*e.curIndex)+"deg)"):i.css("transform","rotateX("+(a+90*e.curIndex)+"deg)")),t.eq(e.curIndex)&&t.eq(e.curIndex).css("visibility","visible"),t.eq(e.curIndex+1)&&t.eq(e.curIndex+1).css("visibility","visible"),t.eq(e.curIndex+2)&&t.eq(e.curIndex+2).css("visibility","visible")):(t.eq(e.curIndex)&&t.eq(e.curIndex).css("visibility","visible"),t.eq(e.curIndex+1)&&t.eq(e.curIndex+1).css("visibility","visible"),t.eq(e.curIndex-1)&&t.eq(e.curIndex-1).css("visibility","visible"))})},changePosEnd:function(){var e=this,t=e.getItemsLength(),n=e.isHorizontal,i=e.bannerWrapper,a=e.loop?e.curIndex+1:e.curIndex,o=-1*a*(e.itemSize+e.itemSpacing);e.loop&&(e.curIndex>=t-2?(e.curIndex=0,o=-1*(e.curIndex+1)*(e.itemSize+e.itemSpacing),n&&i.css("left",o+"px"),!n&&i.css("top",o+"px")):e.curIndex===-1&&(e.curIndex=t-3,o=-1*(e.curIndex+1)*(e.itemSize+e.itemSpacing),n&&i.css("left",o+"px"),!n&&i.css("top",o+"px"))),e.animated=!1,e.offset=0},changeOpacityEnd:function(){for(var e=this,t=e.items,n=e.getItemsLength(),i=e.loop?e.curIndex+1:e.curIndex,a=0;a<n;a++)t.eq(a).css("opacity","0");t.eq(i).css("opacity",1),e.ieVersion&&e.ieVersion<=8&&t.eq(i).css("filter","alpha(opacity=100)"),e.loop&&(e.curIndex>=n-2?(e.curIndex=0,t.eq(n-1).css("opacity",0),t.eq(e.curIndex+1).css("opacity",1),e.ieVersion<=8&&t.eq(n-1).css("filter","alpha(opacity=0)"),e.ieVersion<=8&&t.eq(e.curIndex+1).css("filter","alpha(opacity=100)")):e.curIndex===-1&&(e.curIndex=n-2,t.eq(0).css("opacity",0),t.eq(n-2).css("opacity",1),e.ieVersion<=8&&t.eq(0).css("filter","alpha(opacity=0)"),e.ieVersion<=8&&t.eq(n-2).css("filter","alpha(opacity=100)"))),e.animated=!1,e.offset=0},next:function(){var e=this,t=e.getItemsLength();e.animated||(e.curIndex++,!e.loop&&e.curIndex>t-1&&(e.curIndex=0),e.play(e.curIndex))},prev:function(){var e=this,t=e.getItemsLength();e.animated||(e.curIndex--,!e.loop&&e.curIndex<0&&(e.curIndex=t-1),e.play(e.curIndex))},autoplay:function(){var e=this,t="number"==typeof e.opts.interval&&e.opts.interval>0?parseInt(e.opts.interval):3e3;e.timer=setInterval(function(){e.next()},t)},pagination:function(){var t=this,n="banner-pagination-bullet",i=t.loop?t.getItemsLength()-2:t.getItemsLength(),a="string"==typeof t.opts.paginationClass?t.opts.paginationClass:"",o="boolean"!=typeof t.opts.paginationClickable||t.opts.paginationClickable;t.paginationDom=e("<div class = 'banner-pagination'>"),""!==a&&(n=n+" "+a);for(var s=0;s<i;s++)t.paginationDom.append("<span class = '"+n+"'></span>");if(t.$ele.append(t.paginationDom),t.setPagination(0),o&&t.addPaginationEvent(),t.isHorizontal)t.paginationDom.css({bottom:"10px",width:"100%"});else if(!t.isFlex){var r=t.paginationDom.outerWidth();t.paginationDom.css("margin-top",-r/2+"px")}},setPagination:function(e){var t=this,n="banner-pagination-bullet-active",i=t.opts.pagination?t.paginationDom.children():null,a=t.loop?t.getItemsLength()-2:t.getItemsLength(),o=(t.opts.pagination&&"string"==typeof t.opts.paginationClass?t.opts.paginationClass:"",t.opts.pagination&&"string"==typeof t.opts.paginationActiveClass?t.opts.paginationActiveClass:"");if(t.opts.pagination){""!==o&&(n=n+" "+o);for(var s=0;s<i.length;s++)i.eq(s).removeClass(n);t.loop&&e<0?e=a-1:t.loop&&e===a&&(e=0),i.eq(e).addClass(n)}},addPaginationEvent:function(){var t=this;t.paginationDom.on(t.eventType,"span",function(n){n=n||window.event,t.stopPrevent(n);var i=e(this).index();t.curIndex!==i&&(t.curIndex=i,t.play(t.curIndex))})},initEvent:function(){var e=this,t="boolean"!=typeof e.opts.keyboard||e.opts.keyboard,n="boolean"==typeof e.opts.mousewheel&&e.opts.mousewheel;"pc"===e.judgePlatform()&&(t&&e.bindKeyEvent(),n&&e.mousewheel(),e.mouseHover()),e.swiperEvent()},bindKeyEvent:function(){var t=this;e(document).on("keydown",function(e){e=e||window.event;var n=e.keyCode;t.isHorizontal?37===n?t.prev():39===n&&t.next():38===n?t.prev():40===n&&t.next()})},mouseHover:function(){var e=this;e.bannerWrapper.on("mouseover",function(){e.timer&&clearInterval(e.timer)}).on("mouseout",function(){e.autoplay()})},mousewheel:function(){var t=this;e(document).on("mousewheel DOMMouseScroll",function(e){e=e||window.event;var n=e.originalEvent.wheelDelta;e.detail&&(n=-e.detail),n>0?t.prev():n<0&&t.next()})},arrow:function(){var t=this,n=e("<div class = 'banner-prev-arrow'>"),i=e("<div class = 'banner-next-arrow'>");t.$ele.append(n).append(i),n.on(t.eventType,function(e){e=e||window.event,t.stopPrevent(e),t.prev()}),i.on(t.eventType,function(e){e=e||window.event,t.stopPrevent(e),t.next()})},getIeVersion:function(){var e=navigator.userAgent.toLowerCase();return window.ActiveXObject?e.indexOf("compatible")>-1?parseInt(e.match(/msie ([\d.]+)/)[1]):void 0:e.indexOf("trident")>-1?"edge":void 0},getAnimation:function(){var e=this,t="string"==typeof e.opts.animation?e.opts.animation:"slide";return["slide","fade","cube"].indexOf(t)===-1?t="slide":e.isFlex||"cube"!==t?"cube"===t&&void 0!==e.ieVersion&&(t="slide"):t="slide",t},isSupportFlex:function(){return!!(this._prefix("box")||this._prefix("flex")||this._prefix("flexbox"))},judgePlatform:function(){for(var e=navigator.userAgent.toLowerCase(),t=["android","iphone","symbianos","windows phone","ipad","ipod"],n="",i=0;i<t.length;i++){if(e.indexOf(t[i])>0){n="mobile";break}n="pc"}return n},getItemsLength:function(){return this.items.length},_prefix:function(e){var t=document.createElement("dummy").style,n=["webkit","moz","o","ms"],i="";if(void 0!==t[e])return e;e=e.charAt(0).toUpperCase()+e.substr(1);for(var a in n)if(i=n[a].toString().toLowerCase()+e,void 0!==t[i])return i;return!1}},e.fn.Banner=function(n){return this.each(function(){new t(e(this),n)})},e.fn.Banner.defaults={loop:!0,speed:500,arrow:!1,startIndex:0,interval:3e3,itemSpacing:0,keyboard:!0,autoplay:!0,pagination:!0,mousewheel:!0,animation:"slide",direction:"horizontal",paginationClickable:!0,paginationClass:"",paginationActiveClass:""}}(jQuery);